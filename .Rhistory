xlim(0, 1)+
ylim(0,1.1)+
theme(legend.position = "top")+
guides(color=guide_legend(nrow=2))
# png(filename = "loess_tst_fit_to_all_scen_by_LU.png", width=800, height=800)
# windows()
Fig7b
# dev.off()
Fig7_Loess <- ggarrange(Fig7a, Fig7b)
annotate_figure(Fig7_Loess, bottom = "Percent of Simulated Years")
Fig7_Loess
annotate_figure(Fig7_Loess, bottom = text_grob("Percent of Simulated Years", size=9))
Fig7_Loess <- ggarrange(Fig7a, Fig7b)
annotate_figure(Fig7_Loess, bottom = "Percent of Simulated Years")
png("Fig7_AFbyFactor.png", width = 190, height=102, units = "mm", res = 300)
Fig7_Loess
annotate_figure(Fig7_Loess, bottom = text_grob("Percent of Simulated Years", size=9))
dev.off()
area.curves.by.LU.tst <- area.curves.by.LU %>%
filter(Pothole != chars.potholes$pothole[6])
Fig7b <- ggplot(area.curves.by.LU.tst, aes(x=pct, y=area.pct, color=group))+
geom_smooth(method = "loess", se=T, alpha=0.5)+
theme_bw(base_size = 9)+
scale_color_discrete(name=NULL,
breaks=c("CSCV", "CSCT", "CSNT", "RCV", "RCT", "RNT", "RR"),
labels=c("DX-CS-CV", "DX-CS-CT",
"DX-CS-NT", "DX-R-CV",
"DX-R-CT", "DX-R-NT",
"DX-R-R"))+
# scale_color_discrete(labels=function(x) str_wrap(x, width = 1))+
labs(
x=NULL,
y=NULL#,
# color="Drainage Status"#,
# title="All potholes but Mouth"
)+
xlim(0, 1)+
ylim(0,1.1)+
theme(legend.position = "top")+
guides(color=guide_legend(nrow=2))
# png(filename = "loess_tst_fit_to_all_scen_by_LU.png", width=800, height=800)
# windows()
Fig7b
# dev.off()
area.curves.by.LU.tst <- area.curves.by.LU %>%
filter(Pothole != chars.potholes$pothole[6])
Fig7b <- ggplot(area.curves.by.LU.tst, aes(x=pct, y=area.pct, color=group))+
geom_smooth(method = "loess", se=T, alpha=0.35)+
theme_bw(base_size = 9)+
scale_color_discrete(name=NULL,
breaks=c("CSCV", "CSCT", "CSNT", "RCV", "RCT", "RNT", "RR"),
labels=c("DX-CS-CV", "DX-CS-CT",
"DX-CS-NT", "DX-R-CV",
"DX-R-CT", "DX-R-NT",
"DX-R-R"))+
# scale_color_discrete(labels=function(x) str_wrap(x, width = 1))+
labs(
x=NULL,
y=NULL#,
# color="Drainage Status"#,
# title="All potholes but Mouth"
)+
xlim(0, 1)+
ylim(0,1.1)+
theme(legend.position = "top")+
guides(color=guide_legend(nrow=2))
# png(filename = "loess_tst_fit_to_all_scen_by_LU.png", width=800, height=800)
# windows()
Fig7b
# dev.off()
# FIG TESTING S4.4 ====
Fig7a <- ggplot(area.curves.by.drain.tst, aes(x=pct, y=area.pct, color=group))+
geom_smooth(method = "loess", se=TRUE, alpha=0.35)+
theme_bw(base_size = 9)+
scale_color_discrete(name=NULL,
breaks=c("drain0", "drain1", "drain2", "drain3"),
labels=c("D0-X-X", "D1-X-X",
"D2-X-X", "D3-X-X"))+
labs(
x=NULL,
y="Percent of Total Pothole Area"#,
# color="Drainage Status"#,
# title="All potholes but Mouth"
)+
xlim(0, 1)+
ylim(0,1.1)+
theme(legend.position = "top")+
guides(color=guide_legend(nrow=2))
# png(filename = "loess_tst_fit_to_all_scen_by_pothole.png", width=800, height=800)
# windows()
Fig7a
# dev.off()
Fig7_Loess <- ggarrange(Fig7a, Fig7b)
annotate_figure(Fig7_Loess, bottom = text_grob("Percent of Simulated Years", size=9))
png("Fig7_AFbyFactor.png", width = 190, height=102, units = "mm", res = 300)
Fig7_Loess
annotate_figure(Fig7_Loess, bottom = text_grob("Percent of Simulated Years", size=9))
dev.off()
Fig7_Loess <- ggarrange(Fig7a, Fig7b, labels = c("A", "B"))
annotate_figure(Fig7_Loess, bottom = text_grob("Percent of Simulated Years", size=9))
png("Fig7_AFbyFactor.png", width = 190, height=102, units = "mm", res = 300)
Fig7_Loess
annotate_figure(Fig7_Loess, bottom = text_grob("Percent of Simulated Years", size=9))
dev.off()
Fig7_Loess <- ggarrange(Fig7a, Fig7b, labels = c("A", "B"))
annotate_figure(Fig7_Loess, bottom = text_grob("Percent of Simulated Years", size=9))
png("Fig7_AFbyFactor.png", width = 190, height=102, units = "mm", res = 300)
Fig7_Loess
annotate_figure(Fig7_Loess, bottom = text_grob("Percent of Simulated Years", size=9))
dev.off()
knitr::opts_chunk$set(echo = TRUE)
# LIBRARY ====
library(tidyr)
library(dplyr)
library(ggplot2)
library(reshape2)
library(ggpubr)
# png(filename = "Fig3_MaxArea.png", width=190, height=190, units="mm", res=300)
arr <- ggarrange(
m1+theme(axis.text.x = element_blank()),
m2+theme(axis.text.x = element_blank(), axis.text.y = element_blank()),
m3,
m4+theme(axis.text.y = element_blank()),
labels = c("A", "B", "C", "D"),
ncol = 2,
nrow = 2
)
annotate_figure(arr,
left =text_grob("Pothole Surface Area (m^2)", rot = 90),
bottom = text_grob("Month"))
# dev.off()
# png(filename = "Fig3_MaxArea.png", width=190, height=190, units="mm", res=300)
arr <- ggarrange(
m1+theme(axis.text.x = element_blank()),
m2+theme(axis.text.x = element_blank(), axis.text.y = element_blank()),
m3,
m4+theme(axis.text.y = element_blank()),
labels = c("A", "B", "C", "D"),
label.x = c(-0.1, -0.1, -0.1, -0.1),
ncol = 2,
nrow = 2
)
annotate_figure(arr,
left =text_grob("Pothole Surface Area (m^2)", rot = 90),
bottom = text_grob("Month"))
# dev.off()
# png(filename = "Fig3_MaxArea.png", width=190, height=190, units="mm", res=300)
arr <- ggarrange(
m1+theme(axis.text.x = element_blank()),
m2+theme(axis.text.x = element_blank(), axis.text.y = element_blank()),
m3,
m4+theme(axis.text.y = element_blank()),
labels = c("A", "B", "C", "D"),
label.x = c(-0.05, -0.05, -0.05, -0.05),
ncol = 2,
nrow = 2
)
annotate_figure(arr,
left =text_grob("Pothole Surface Area (m^2)", rot = 90),
bottom = text_grob("Month"))
# dev.off()
# png(filename = "Fig3_MaxArea.png", width=190, height=190, units="mm", res=300)
arr <- ggarrange(
m1+theme(axis.text.x = element_blank()),
m2+theme(axis.text.x = element_blank(), axis.text.y = element_blank()),
m3,
m4+theme(axis.text.y = element_blank()),
labels = c("A", "B", "C", "D"),
label.x = c(-0.02, -0.02, -0.02, -0.02),
ncol = 2,
nrow = 2
)
annotate_figure(arr,
left =text_grob("Pothole Surface Area (m^2)", rot = 90),
bottom = text_grob("Month"))
# dev.off()
png(filename = "Fig3_MaxArea.png", width=190, height=190, units="mm", res=300)
arr <- ggarrange(
m1+theme(axis.text.x = element_blank()),
m2+theme(axis.text.x = element_blank(), axis.text.y = element_blank()),
m3,
m4+theme(axis.text.y = element_blank()),
labels = c("A", "B", "C", "D"),
label.x = c(-0.02, -0.02, -0.02, -0.02),
ncol = 2,
nrow = 2
)
annotate_figure(arr,
left =text_grob("Pothole Surface Area (m^2)", rot = 90),
bottom = text_grob("Month"))
dev.off()
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(ggpubr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(ggpubr)
days.data.drain.all <- read.csv("CH3_days_flooded.csv", header=T, sep=",")
days.data.drain.all$all <- c(rep("All", length(days.data.drain.all$X)))
# create graph for annual ponded days for all variables
#
# days.data.drain.all <-
#   rbind(days.data.drain0, days.data.drain1, days.data.drain2,days.data.drain3)
# days.data.drain.all <-
#   rbind(
#     days.data.CSCV,
#     days.data.CSCT,
#     days.data.CSNT,
#     days.data.RCV,
#     days.data.RCT,
#     days.data.RNT,
#     days.data.RR
#   )
# days.data.drain.all$code[days.data.drain.all$code == "DX-R-CV"] <- "D0-R-CV"
# days.data.drain.all$bins <- character(length(days.data.drain.all$Pothole))
# days.data.drain.all$bins <- c(rep("No Drainage", 126),rep("SS Drainage", 126),rep("SS + SI", 126),rep("SS + Multiple SI", 126))
# head(days.data.drain.all)
#
# days.data.drain.all$code2 <-
#   factor(
#     days.data.drain.all$code,
#     levels = c(
#       "D0-CS-CV",
#       "D0-CS-CT",
#       "D0-CS-NT",
#       "D0-R-CV",
#       "D0-R-CT",
#       "D0-R-NT",
#       "D0-R-R",
#       "D1-CS-CV",
#       "D1-CS-CT",
#       "D1-CS-NT",
#       "D1-R-CV",
#       "D1-R-CT",
#       "D1-R-NT",
#       "D1-R-R",
#       "D2-CS-CV",
#       "D2-CS-CT",
#       "D2-CS-NT",
#       "D2-R-CV",
#       "D2-R-CT",
#       "D2-R-NT",
#       "D2-R-R",
#       "D3-CS-CV",
#       "D3-CS-CT",
#       "D3-CS-NT",
#       "D3-R-CV",
#       "D3-R-CT",
#       "D3-R-NT",
#       "D3-R-R"
#     )
#   )
boxplot.function.partitioned.no.wetness2 <- function(data.df, title, nm, supp.labs, labnms) {
png(paste("days_all_",nm,".png"), width=800, height=400)
plot.avg.annual.by.wetness <- ggplot(data=data.df, aes(x=code2, y=value))+
geom_boxplot(alpha=0.5) +
facet_grid(rows=vars(all)) +
theme_bw(base_size = 8) +
theme(axis.text.x =element_blank()) +
ylim(0, 150)+
labs(
y = NULL,
x = NULL#,
# title = title
)
return(plot.avg.annual.by.wetness)
}
# boxplot.function.partitioned2 <-
#   function(data.df, title, nm, supp.labs, labnms) {
#     # png(paste("days.", nm, ".png"),
#         # width = 700,
#         # height = 700)
#
#     plot.avg.annual.by.wetness <-
#       ggplot(data = data.df, aes(x = code, y = value)) +
#       geom_boxplot(alpha = 0.5) +
#       facet_grid(rows = vars(Pothole)
#                  # ,
#                  # labeller = labeller(
#                  #   Pothole = c(high = "High Precip", low = "Low Precip",
#                  #               med = "Medium Precip")
#                  # )
#                  ) +
#       theme_bw(base_size = 9)+
#       theme(axis.text.x = element_text(angle = 90)) +
#       ylim(0, 150) +
#       labs(y = "Average Annual Days of Flooding",
#            x = "Simulated Scenario",
#            title = title)
#
#     return(plot.avg.annual.by.wetness)
#
#   }
boxplot.function.partitioned <- function(data.df, title, nm, supp.labs, labnms) {
df <- data.df
df$wetness2 <- factor(df$wetness, levels = c("low", "med", "high"))
# png(paste("days.",nm,".png"), width=700, height=700)
plot.avg.annual.by.wetness <- ggplot(data=df, aes(x=code2, y=value))+
geom_boxplot(alpha=0.5) +
facet_grid(rows=vars(wetness2),
labeller = labeller(wetness2 = c(high = "High", low="Low",
med="Medium"))) +
theme_bw(base_size = 8) +
theme(axis.text.x =element_text(angle = 90)) +
ylim(0, 150)+
labs(
y = NULL,
x = NULL
)
return(plot.avg.annual.by.wetness)
}
fig4.2 <-
boxplot.function.partitioned.no.wetness2(days.data.drain.all, "All Data", "alldata", simulation_shortIDs2, simulation_names2)
# dev.off()
fig4.2data <- as.data.frame(layer_data(fig4.2, 1))
# lapply(fig4.2data, function(x) write.table( data.frame(x), 'test.csv'  , append= T, sep=',' ))
fig4.2b <-
boxplot.function.partitioned(days.data.drain.all, "All Data", "alldata", simulation_shortIDs2, simulation_names2)
# dev.off()
# fig4.2c <- boxplot.function.partitioned2(days.data.drain.all, "All Data", "alldata2", simulation_shortIDs2, simulation_names2)
# dev.off()
fig4.2bdata <- as.data.frame(layer_data(fig4.2b, 1))
# lapply(fig4.2bdata, function(x) write.table( data.frame(x), 'test2.csv'  , append= T, sep=',' ))
fig4.2
fig4.2b
# fig4.2c
png("Fig4_DaysInundated.png", width = 135, height = 150, units = "mm", res=300)
FigDays <- ggarrange(fig4.2, fig4.2b,
ncol = 1)
annotate_figure(FigDays, left=text_grob("Average Annual Days of Flooding", rot = 90),
bottom=text_grob("Scenario"))
dev.off()
FigDays <- ggarrange(fig4.2, fig4.2b,
ncol = 1)
annotate_figure(FigDays, left=text_grob("Average Annual Days of Flooding", rot = 90),
bottom=text_grob("Scenario"))
days.data.drain.all$code2 <-
factor(
days.data.drain.all$code,
levels = c(
"D0-CS-CV",
"D0-CS-CT",
"D0-CS-NT",
"D0-R-CV",
"D0-R-CT",
"D0-R-NT",
"D0-R-R",
"D1-CS-CV",
"D1-CS-CT",
"D1-CS-NT",
"D1-R-CV",
"D1-R-CT",
"D1-R-NT",
"D1-R-R",
"D2-CS-CV",
"D2-CS-CT",
"D2-CS-NT",
"D2-R-CV",
"D2-R-CT",
"D2-R-NT",
"D2-R-R",
"D3-CS-CV",
"D3-CS-CT",
"D3-CS-NT",
"D3-R-CV",
"D3-R-CT",
"D3-R-NT",
"D3-R-R"
)
)
# create graph for annual ponded days for all variables
#
# days.data.drain.all <-
#   rbind(days.data.drain0, days.data.drain1, days.data.drain2,days.data.drain3)
# days.data.drain.all <-
#   rbind(
#     days.data.CSCV,
#     days.data.CSCT,
#     days.data.CSNT,
#     days.data.RCV,
#     days.data.RCT,
#     days.data.RNT,
#     days.data.RR
#   )
# days.data.drain.all$code[days.data.drain.all$code == "DX-R-CV"] <- "D0-R-CV"
# days.data.drain.all$bins <- character(length(days.data.drain.all$Pothole))
# days.data.drain.all$bins <- c(rep("No Drainage", 126),rep("SS Drainage", 126),rep("SS + SI", 126),rep("SS + Multiple SI", 126))
# head(days.data.drain.all)
#
days.data.drain.all$code2 <-
factor(
days.data.drain.all$code,
levels = c(
"D0-CS-CV",
"D0-CS-CT",
"D0-CS-NT",
"D0-R-CV",
"D0-R-CT",
"D0-R-NT",
"D0-R-R",
"D1-CS-CV",
"D1-CS-CT",
"D1-CS-NT",
"D1-R-CV",
"D1-R-CT",
"D1-R-NT",
"D1-R-R",
"D2-CS-CV",
"D2-CS-CT",
"D2-CS-NT",
"D2-R-CV",
"D2-R-CT",
"D2-R-NT",
"D2-R-R",
"D3-CS-CV",
"D3-CS-CT",
"D3-CS-NT",
"D3-R-CV",
"D3-R-CT",
"D3-R-NT",
"D3-R-R"
)
)
boxplot.function.partitioned.no.wetness2 <- function(data.df, title, nm, supp.labs, labnms) {
png(paste("days_all_",nm,".png"), width=800, height=400)
plot.avg.annual.by.wetness <- ggplot(data=data.df, aes(x=code2, y=value))+
geom_boxplot(alpha=0.5) +
facet_grid(rows=vars(all)) +
theme_bw(base_size = 8) +
theme(axis.text.x =element_blank()) +
ylim(0, 150)+
labs(
y = NULL,
x = NULL#,
# title = title
)
return(plot.avg.annual.by.wetness)
}
# boxplot.function.partitioned2 <-
#   function(data.df, title, nm, supp.labs, labnms) {
#     # png(paste("days.", nm, ".png"),
#         # width = 700,
#         # height = 700)
#
#     plot.avg.annual.by.wetness <-
#       ggplot(data = data.df, aes(x = code, y = value)) +
#       geom_boxplot(alpha = 0.5) +
#       facet_grid(rows = vars(Pothole)
#                  # ,
#                  # labeller = labeller(
#                  #   Pothole = c(high = "High Precip", low = "Low Precip",
#                  #               med = "Medium Precip")
#                  # )
#                  ) +
#       theme_bw(base_size = 9)+
#       theme(axis.text.x = element_text(angle = 90)) +
#       ylim(0, 150) +
#       labs(y = "Average Annual Days of Flooding",
#            x = "Simulated Scenario",
#            title = title)
#
#     return(plot.avg.annual.by.wetness)
#
#   }
boxplot.function.partitioned <- function(data.df, title, nm, supp.labs, labnms) {
df <- data.df
df$wetness2 <- factor(df$wetness, levels = c("low", "med", "high"))
# png(paste("days.",nm,".png"), width=700, height=700)
plot.avg.annual.by.wetness <- ggplot(data=df, aes(x=code2, y=value))+
geom_boxplot(alpha=0.5) +
facet_grid(rows=vars(wetness2),
labeller = labeller(wetness2 = c(high = "High", low="Low",
med="Medium"))) +
theme_bw(base_size = 8) +
theme(axis.text.x =element_text(angle = 90)) +
ylim(0, 150)+
labs(
y = NULL,
x = NULL
)
return(plot.avg.annual.by.wetness)
}
fig4.2 <-
boxplot.function.partitioned.no.wetness2(days.data.drain.all, "All Data", "alldata", simulation_shortIDs2, simulation_names2)
# dev.off()
fig4.2data <- as.data.frame(layer_data(fig4.2, 1))
# lapply(fig4.2data, function(x) write.table( data.frame(x), 'test.csv'  , append= T, sep=',' ))
fig4.2b <-
boxplot.function.partitioned(days.data.drain.all, "All Data", "alldata", simulation_shortIDs2, simulation_names2)
# dev.off()
# fig4.2c <- boxplot.function.partitioned2(days.data.drain.all, "All Data", "alldata2", simulation_shortIDs2, simulation_names2)
# dev.off()
fig4.2bdata <- as.data.frame(layer_data(fig4.2b, 1))
# lapply(fig4.2bdata, function(x) write.table( data.frame(x), 'test2.csv'  , append= T, sep=',' ))
fig4.2
fig4.2
fig4.2b
# fig4.2c
png("Fig4_DaysInundated.png", width = 135, height = 150, units = "mm", res=300)
FigDays <- ggarrange(fig4.2, fig4.2b,
ncol = 1)
annotate_figure(FigDays, left=text_grob("Average Annual Days of Flooding", rot = 90),
bottom=text_grob("Scenario"))
dev.off()
FigDays <- ggarrange(fig4.2, fig4.2b,
ncol = 1)
annotate_figure(FigDays, left=text_grob("Average Annual Days of Flooding", rot = 90),
bottom=text_grob("Scenario"))
