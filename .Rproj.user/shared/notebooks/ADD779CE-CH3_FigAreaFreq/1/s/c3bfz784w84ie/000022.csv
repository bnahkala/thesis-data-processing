"0",""
"0","# LIBRARY ====="
"0","library(dplyr)"
"0","library(tidyr)"
"0","library(ggplot2)"
"0","library(gridExtra)"
"0","library(ggpubr)"
"0","library(purrr)"
"0",""
"0","# NAME METADATA ===="
"0","simulation_shortIDs <- data.frame(""Drain0"" = c(""D0-CS-CV"", ""D0-CS-CT"", ""D0-CS-NT"", ""D0-R-CV"", ""D0-R-CT"", ""D0-R-NT"",""D0-R-R""),"
"0","                                  ""Drain1"" = c(""D1-CS-CV"", ""D1-CS-CT"", ""D1-CS-NT"", ""D1-R-CV"", ""D1-R-CT"", ""D1-R-NT"",""D1-R-R""),"
"0","                                  ""Drain2"" = c(""D2-CS-CV"", ""D2-CS-CT"", ""D2-CS-NT"", ""D2-R-CV"", ""D2-R-CT"", ""D2-R-NT"",""D2-R-R""),"
"0","                                  ""Drain3"" = c(""D3-CS-CV"", ""D3-CS-CT"", ""D3-CS-NT"", ""D3-R-CV"", ""D3-R-CT"", ""D3-R-NT"",""D3-R-R""))"
"0","simulation_shortIDs2 <- data.frame(""CSCV"" = c(""D0-CS-CV"", ""D1-CS-CV"", ""D2-CS-CV"", ""D3-CS-CV""),"
"0","                                   ""CSCT"" = c(""D0-CS-CT"", ""D1-CS-CT"", ""D2-CS-CT"", ""D3-CS-CT""),"
"0","                                   ""CSNT"" = c(""D0-CS-NT"", ""D1-CS-NT"", ""D2-CS-NT"", ""D3-CS-NT""),"
"0","                                   ""RCV"" = c(""D0-R-CV"", ""D1-R-CV"", ""D2-R-CV"", ""D3-R-CV""),"
"0","                                   ""RCT"" = c(""D0-R-CT"", ""D1-R-CT"", ""D2-R-CT"", ""D3-R-CT""),"
"0","                                   ""RNT"" = c(""D0-R-NT"", ""D1-R-NT"", ""D2-R-NT"", ""D3-R-NT""),"
"0","                                   ""RR"" = c(""D0-R-R"", ""D1-R-R"", ""D2-R-R"", ""D3-R-R""))"
"0","simulation_shortIDs3 <- data.frame(""PDCC"" = c(""DX-X-CV"",""PD-2E"", ""PD-2L"", ""PD-4L"", ""PD-6L"", ""DX-CC-NT""))"
"0",""
"0","ids <- simulation_shortIDs %>%"
"0","  gather(key=""type"", ""id"", 1:4)"
"2","attributes are not identical across measure variables;
they will be dropped"
"0","ids2 <- simulation_shortIDs2 %>%"
"0","  gather(key=""type"", ""id"", 1:7)"
"2","attributes are not identical across measure variables;
they will be dropped"
"0","ids3 <- simulation_shortIDs3 %>%"
"0","  gather(key=""type"", ""id"", 1)"
"0",""
"0","ids <- ids %>%"
"0","  bind_rows(ids3) "
"0",""
"0","simulation_names <- data.frame(""Drain0"" = c(""Drain0"", ""Drain0CT"", ""Drain0NT"", ""RetiredPothole"", ""ConTillRetired"", ""NoTillRetired"",""RetiredAll""),"
"0","                               ""Drain1"" = c(""Drain01"", ""ConTillDrain01"", ""Drain1NT"", ""Drain1Retired"", ""Drain1RetiredCT"", ""Drain1RetiredNT"",""Drain1RetiredAll""),"
"0","                               ""Drain2"" = c(""Drain02"", ""ConTillDrain02"", ""Drain2NT"", ""Drain2Retired"", ""Drain2RetiredCT"", ""Drain2RetiredNT"",""Drain2RetiredAll""),"
"0","                               ""Drain3"" = c(""Drain03"", ""ConTillDrain03"", ""Drain3NT"", ""Drain3Retired"", ""Drain3RetiredCT"", ""Drain3RetiredNT"",""Drain3RetiredAll""))"
"0","simulation_names2 <- data.frame(""CSCV"" = c(""Drain0"", ""Drain01"", ""Drain02"", ""Drain03""),"
"0","                                ""CSCT"" = c(""Drain0CT"", ""ConTillDrain01"", ""ConTillDrain02"", ""ConTillDrain03""),"
"0","                                ""CSNT"" = c(""Drain0NT"", ""Drain1NT"", ""Drain2NT"", ""Drain3NT""),"
"0","                                ""RCV"" = c(""RetiredPothole"", ""Drain1Retired"", ""Drain2Retired"", ""Drain3Retired""),"
"0","                                ""RCT"" = c(""ConTillRetired"", ""Drain1RetiredCT"", ""Drain2RetiredCT"", ""Drain3RetiredCT""),"
"0","                                ""RNT"" = c(""NoTillRetired"", ""Drain1RetiredNT"", ""Drain2RetiredNT"", ""Drain3RetiredNT""),"
"0","                                ""RR"" = c(""RetiredAll"", ""Drain1RetiredAll"", ""Drain2RetiredAll"", ""Drain3RetiredAll""))"
"0","simulation_names3 <- data.frame(""PDCC"" = c(""Base"", ""PlantDate01"", ""PlantDate02"", ""PlantDate03"", ""PlantDate04"", ""CoverCrop""))"
"0",""
"0","nms <- simulation_names %>%"
"0","  gather(key=""type"", ""name"", 1:4)"
"2","attributes are not identical across measure variables;
they will be dropped"
"0","nms2 <- simulation_names2 %>%"
"0","  gather(key=""type"", ""name"", 1:7)"
"2","attributes are not identical across measure variables;
they will be dropped"
"0","nms3 <- simulation_names3 %>%"
"0","  gather(key=""type"", ""name"", 1)"
"0",""
"0","nms <- nms %>%"
"0","  bind_rows(nms3) "
"0",""
"0",""
"0","# VIZ ===="
"0",""
"0","# area.bunny.df.filter <- area.walnut.df %>%"
"0","#   # filter(Base != 0) %>%"
"0","#   gather(key=""scen"", value=""area"", 5:43) %>%"
"0","#   group_by(Year, scen) %>%"
"0","#   summarize(pct.max.year = (max(area)/(chars.potholes$area.max[1]*10000))) #%>%"
"0","#   # filter(Month >= 4 & Month <= 9) #%>%"
"0","#   # summarize(distr=n())"
"0",""
"0","# GENERATE DATA ===="
"0","pct.area.data.function <- function(data.df, id) {"
"0","  "
"0","  temp <- data.df %>%"
"0","    # filter(Base != 0) %>%"
"0","    gather(key=""scen"", value=""area"", 5:43) %>%"
"0","    group_by(Year, scen) %>%"
"0","    summarize(pct.max.year = (max(area)/(chars.potholes$area.max[id]*10000))) #%>%"
"0","  # filter(Month >= 4 & Month <= 9) #%>%"
"0","  # summarize(distr=n())"
"0","  "
"0","  "
"0","  zero <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year >= 0) %>%"
"0","    summarize(zero = n()/25)"
"0","  "
"0","  one <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.1) %>%"
"0","    summarize(one = n()/25)"
"0","  "
"0","  two <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.2) %>%"
"0","    summarize(two = n()/25)"
"0","  "
"0","  three <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.3) %>%"
"0","    summarize(three = n()/25)"
"0","  "
"0","  four <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.4) %>%"
"0","    summarize(four = n()/25)"
"0","  "
"0","  five <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.5) %>%"
"0","    summarize(five = n()/25)"
"0","  "
"0","  six <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.6) %>%"
"0","    summarize(six = n()/25)"
"0","  "
"0","  seven <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.7) %>%"
"0","    summarize(seven = n()/25)"
"0","  "
"0","  eight <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.8) %>%"
"0","    summarize(eight = n()/25)"
"0","  "
"0","  nine <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year > 0.9) %>%"
"0","    summarize(nine = n()/25)"
"0","  "
"0","  ten <- temp %>%"
"0","    group_by(scen) %>%"
"0","    filter(pct.max.year >= 1.0) %>%"
"0","    summarize(ten = n()/25)"
"0","  "
"0","  all <- merge(zero, one, by=""scen"", all=TRUE)"
"0","  all <- merge(all, two, by=""scen"", all=TRUE)"
"0","  all <- merge(all, three, by=""scen"", all=TRUE)"
"0","  all <- merge(all, four, by=""scen"", all=TRUE)"
"0","  all <- merge(all, five, by=""scen"", all=TRUE)"
"0","  all <- merge(all, six, by=""scen"", all=TRUE)"
"0","  all <- merge(all, seven, by=""scen"", all=TRUE)"
"0","  all <- merge(all, eight, by=""scen"", all=TRUE)"
"0","  all <- merge(all, nine, by=""scen"", all=TRUE)"
"0","  all <- merge(all, ten, by=""scen"", all=TRUE)"
"0","  "
"0","  colnames(all) <- c(""scen"", ""zero"", ""one"", ""two"", ""three"", ""four"", ""five"", ""six"", ""seven"", ""eight"", ""nine"", ""ten"")"
"0","  "
"0","  all.melt <- all %>%"
"0","    gather(key = ""range"", value=""pct"", 2:12)"
"0","  "
"0","  all.melt$area.pct <- c(rep(0, 39), rep(0.1, 39), rep(0.2, 39),rep(0.3, 39),rep(0.4, 39),rep(0.5, 39),rep(0.6, 39),"
"0","                         rep(0.7, 39),rep(0.8, 39),rep(0.9, 39),rep(1, 39))"
"0","  "
"0","  all.melt$pct[is.na(all.melt$pct)] <- 0"
"0","  "
"0","  return(all.melt)"
"0","  "
"0","}"
"0",""
"0","area.curve.bunny <- pct.area.data.function(area.bunny.df, 1)"
"0","area.curve.walnut <- pct.area.data.function(area.walnut.df, 2)"
"0","area.curve.lettuce <- pct.area.data.function(area.lettuce.df, 3)"
"0","area.curve.cardinal <- pct.area.data.function(area.cardinal.df, 4)"
"0","area.curve.hen <- pct.area.data.function(area.hen.df, 5)"
"0","area.curve.mouth <- pct.area.data.function(area.mouth.df, 6)"
"0",""
"0","area.curve.all <- area.curve.bunny %>%"
"0","  bind_rows(area.curve.walnut) %>%"
"0","  bind_rows(area.curve.lettuce) %>%"
"0","  bind_rows(area.curve.cardinal) %>%"
"0","  bind_rows(area.curve.hen) %>%"
"0","  bind_rows(area.curve.mouth) "
"0",""
"0","area.curve.all$Pothole <- c(rep(""Bunny"", 429),rep(""Walnut"", 429),rep(""Lettuce"", 429),"
"0","                            rep(""Cardinal"", 429),rep(""Hen"", 429),rep(""Mouth"", 429))"
"0",""
"0","area.curve.all <- area.curve.all %>%"
"0","  filter(scen %in% nms$name)"
"0",""
"0","# SOME DATA SPLITTING ===="
"0",""
"0","# drainage ====="
"0","area.curve.drain0 <- area.curve.all %>%"
"0","  filter(scen %in% nms$name[nms$type == ""Drain0""])"
"0",""
"0","area.curve.drain0$scen2 <- factor(area.curve.drain0$scen, levels = c(""Drain0"", ""Drain0CT"", ""Drain0NT"","
"0","                                                                     ""RetiredPothole"", ""ConTillRetired"","
"0","                                                                     ""NoTillRetired"", ""RetiredAll""))"
"0",""
"0","area.curve.drain1 <- area.curve.all %>%"
"0","  filter(scen %in% nms$name[nms$type == ""Drain1""])"
"0",""
"0","area.curve.drain1$scen2 <- factor(area.curve.drain1$scen, levels=c(""Drain01"", ""ConTillDrain01"", ""Drain1NT"","
"0","                                                                   ""Drain1Retired"", ""Drain1RetiredCT"", "
"0","                                                                   ""Drain1RetiredNT"", ""Drain1RetiredAll""))"
"0",""
"0","area.curve.drain2 <- area.curve.all %>%"
"0","  filter(scen %in% nms$name[nms$type == ""Drain2""])"
"0",""
"0","area.curve.drain2$scen2 <- factor(area.curve.drain2$scen, levels=c(""Drain02"", ""ConTillDrain02"", ""Drain2NT"","
"0","                                                                   ""Drain2Retired"", ""Drain2RetiredCT"", "
"0","                                                                   ""Drain2RetiredNT"", ""Drain2RetiredAll""))"
"0",""
"0",""
"0","area.curve.drain3 <- area.curve.all %>%"
"0","  filter(scen %in% nms$name[nms$type == ""Drain3""])"
"0",""
"0","area.curve.drain3$scen2 <- factor(area.curve.drain3$scen, levels=c(""Drain03"", ""ConTillDrain03"", ""Drain3NT"","
"0","                                                                   ""Drain3Retired"", ""Drain3RetiredCT"", "
"0","                                                                   ""Drain3RetiredNT"", ""Drain3RetiredAll""))"
"0",""
"0","area.curves.by.drain <- area.curve.drain0 %>%"
"0","  bind_rows(area.curve.drain1) %>%"
"0","  bind_rows(area.curve.drain2) %>%"
"0","  bind_rows(area.curve.drain3) "
"2","Unequal factor levels: coercing to character"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"2","binding character and factor vector, coercing into character vector"
"0","area.curves.by.drain$group <- c(rep(""drain0"", 462),rep(""drain1"", 462),rep(""drain2"", 462),rep(""drain3"", 462))  "
"0",""
"0","write.csv(area.curve.all, file = ""area_curves.csv"")"
"0",""
"0",""
"0","# land use  ====="
"0","area.curve.CSCV <- area.curve.all %>%"
"0","  filter(scen %in% nms2$name[nms2$type == ""CSCV""])"
"0",""
"0","area.curve.CSCT <- area.curve.all %>%"
"0","  filter(scen %in% nms2$name[nms2$type == ""CSCT""])"
"0",""
"0","area.curve.CSNT <- area.curve.all %>%"
"0","  filter(scen %in% nms2$name[nms2$type == ""CSNT""])"
"0",""
"0","area.curve.RCV <- area.curve.all %>%"
"0","  filter(scen %in% nms2$name[nms2$type == ""RCV""])"
"0",""
"0","area.curve.RCT <- area.curve.all %>%"
"0","  filter(scen %in% nms2$name[nms2$type == ""RCT""])"
"0",""
"0","area.curve.RNT <- area.curve.all %>%"
"0","  filter(scen %in% nms2$name[nms2$type == ""RNT""])"
"0",""
"0","area.curve.RR <- area.curve.all %>%"
"0","  filter(scen %in% nms2$name[nms2$type == ""RR""])"
"0",""
"0","area.curves.by.LU <- area.curve.CSCV %>%"
"0","  bind_rows(area.curve.CSCT) %>%"
"0","  bind_rows(area.curve.CSNT) %>%"
"0","  bind_rows(area.curve.RCV) %>%"
"0","  bind_rows(area.curve.RCT) %>%"
"0","  bind_rows(area.curve.RNT) %>%"
"0","  bind_rows(area.curve.RR) "
"0","area.curves.by.LU$group <-"
"0","  c("
"0","    rep(""CSCV"", 264),"
"0","    rep(""CSCT"", 264),"
"0","    rep(""CSNT"", 264),"
"0","    rep(""RCV"", 264),"
"0","    rep(""RCT"", 264),"
"0","    rep(""RNT"", 264),"
"0","    rep(""RR"", 264)"
"0","  )"
"0",""
"0",""
"0","# PLOT DATA ====="
"0","plot.area.curves <- function(data.df, nm, supp.labs, labnms) {"
"0","  "
"0","  labs <- as.character(supp.labs)"
"0","  names(labs) <- as.character(labnms)"
"0","  "
"0","  plt <- ggplot(data.df, aes(x=pct, y=area.pct, color=scen2))+"
"0","    geom_path(linetype=""solid"", size=0.6)+"
"0","    facet_grid(rows = vars(Pothole))+"
"0","    labs("
"0","      x="""","
"0","      y="""","
"0","      color="""""
"0","    )+"
"0","    theme_bw(base_size=9)+"
"0","    theme(legend.position = ""none"")+"
"0","    scale_color_discrete(name=""Simulation Scenario"", labels=labs)+"
"0","    # scale_y_continuous(breaks = c(""0"", ""0.5"",  ""1""))+"
"0","    scale_color_brewer(palette = ""Dark2"", labels=c(""DX-CS-CV"",""DX-CS-CT"",""DX-CS-NT"",""DX-R-CV"",""DX-R-CT"",""DX-R-NT"", ""DX-R-R""))+"
"0","    # ylim(0, 1.1)+"
"0","    xlim(0,1)"
"0","  "
"0","  "
"0","  png(filename=paste0(""area_curves_"", nm,"".png""), width=600, height=600)"
"0","  # windows()"
"0","  plt"
"0","}"
"0",""
"0","# PLOT PARTITIONED SCENARIOS ====="
"0","g1 <- plot.area.curves(area.curve.drain0, ""drain0"", simulation_shortIDs$Drain0, simulation_names$Drain0)"
"2","Scale for 'colour' is already present. Adding another scale for 'colour', which will replace the existing
scale.
"
"0","g1 <- g1 + theme(axis.text.x = element_blank())"
"0","dev.off()"
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","g2 <- plot.area.curves(area.curve.drain1, ""drain1"", simulation_shortIDs$Drain1, simulation_names$Drain1)"
"2","Scale for 'colour' is already present. Adding another scale for 'colour', which will replace the existing
scale.
"
"0","g2 <- g2 + theme(axis.text.x = element_blank()) + theme(axis.text.y = element_blank())"
"0","dev.off() "
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","g3 <- plot.area.curves(area.curve.drain2, ""drain2"", simulation_shortIDs$Drain2, simulation_names$Drain2)"
"2","Scale for 'colour' is already present. Adding another scale for 'colour', which will replace the existing
scale.
"
"0","dev.off() "
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","g4 <- plot.area.curves(area.curve.drain3, ""drain3"", simulation_shortIDs$Drain3, simulation_names$Drain3)"
"2","Scale for 'colour' is already present. Adding another scale for 'colour', which will replace the existing
scale.
"
"0","g4 <- g4  + theme(axis.text.y = element_blank())"
"0","dev.off()"
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","# using ggplots generated in data_viz.R"
"0",""
"0",""
"0","png(filename = ""Fig6_AreaFrequency.png"", height = 190, width = 190, units = ""mm"", res = 300)"
"0",""
"0","arr <- ggarrange("
"0","  g1,"
"0","  g2,"
"0","  g3,"
"0","  g4,"
"0","  labels = c(""A"", ""B"", ""C"", ""D""),"
"0","  ncol = 2,"
"0","  nrow = 2, "
"0","  common.legend = T, "
"0","  legend = ""top"""
"0",")"
"0","annotate_figure(arr, "
"0","                left =text_grob(""Fraction of Maximum Pothole Volume"", rot = 90),"
"0","                bottom = text_grob(""Fraction of Years Simulated""))"
