"0","max.function.partitioned4 <- function(data.df, id, supp.labs, labnms) {"
"0","  temp <- data.df %>%"
"0","    group_by(Month, Pothole, scen, common, level) %>%"
"0","    summarise(avg.max=mean(value), median.max=median(value)) #%>%"
"0","    # filter(avg.max != 0)"
"0","  "
"0","  temp$Month <- factor(temp$Month)"
"0","  temp$common <- factor(temp$common, c(""DX-CS-CV"",""DX-CS-CT"",""DX-CS-NT"",""DX-R-CV"",""DX-R-CT"",""DX-R-NT"",""DX-R-R""))"
"0","  temp$level <- factor(temp$level, levels = c(""D0"", ""D1"", ""D2"", ""D3""))"
"0","  "
"0","  labs <- as.character(supp.labs)"
"0","  names(labs) <- as.character(labnms)"
"0","  "
"0","  png(filename = paste0(""avg_"", id, ""_comparison.png""), width=800, height=500)"
"0","  # windows()"
"0","  plot.max <- ggplot(temp, aes(x=Month, y=avg.max, fill=Pothole))+"
"0","    geom_bar(stat=""identity"", position=""identity"", alpha=0.25, color=""black"", size=0.15)+"
"0","    facet_grid(cols = vars(common), rows = vars(Pothole), labeller = labeller(common = labs))+"
"0","    ylim(0, 25000)+"
"0","    theme_bw(base_size = 8)+"
"0","    # theme(axis.text.x = element_text(angle = 90))+"
"0","    theme(strip.text.x = element_text(size = 8))+"
"0","    theme(legend.position = ""none"")+"
"0","    scale_x_discrete(breaks = c(1, 3, 5, 7, 9 ,11), labels=c(""J"", ""M"", ""M"", ""J"", ""S"", ""N""))+"
"0","    labs("
"0","      x=""Month"","
"0","      y=""Pothole Surface Area (m^2)"")+"
"0","    scale_fill_brewer(palette = ""Dark2"")"
"0","  plot.max"
"0","  return(plot.max)"
"0","}"
