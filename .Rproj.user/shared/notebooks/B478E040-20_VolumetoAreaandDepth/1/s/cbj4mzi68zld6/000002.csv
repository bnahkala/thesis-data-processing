"0",""
"0","# LIBRARY ====="
"0","library(dplyr)"
"2","package ‘dplyr’ was built under R version 3.6.3"
"2","Registered S3 method overwritten by 'dplyr':
  method           from
  print.rowwise_df     
"
"2","
Attaching package: ‘dplyr’

"
"2","The following objects are masked from ‘package:stats’:

    filter, lag

"
"2","The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

"
"0","library(tidyr)"
"0","library(reshape2)"
"2","
Attaching package: ‘reshape2’

"
"2","The following object is masked from ‘package:tidyr’:

    smiths

"
"0","# IMPORT DATA ====="
"0","vol.bunny.df <- read.table(""Bunny_Output_TEST_headers.csv"", header=TRUE, sep="","")"
"0","vol.walnut.df <- read.table(""Walnut_Output_TEST_headers.csv"", header=TRUE, sep="","")"
"0","vol.lettuce.df <- read.table(""Lettuce_Output_TEST_headers.csv"", header=TRUE, sep="","")"
"0","vol.cardinal.df <- read.table(""Cardinal_Output_TEST_headers.csv"", header=TRUE, sep="","")"
"0","vol.mouth.df <- read.table(""Mouth_Output_TEST_headers.csv"", header=TRUE, sep="","")"
"0","vol.hen.df <- read.table(""HenPlume_Output_TEST_headers.csv"", header=TRUE, sep="","")"
"0",""
"0",""
"0","chars.potholes <- data.frame(""pothole"" = c(""Bunny"", ""Walnut"", ""Lettuce"", ""Cardinal"", ""Hen"", ""Mouth""), "
"0","                             ""ca.sa.ratio"" = c(7.5, 3.7, 6.3, 8.7, 6.9, 10.2),"
"0","                             ""depth.max"" = c(1, 0.7, 0.8, 0.8, 0.6, 0.4),"
"0","                             ""area.max"" = c(5.35, 2.6, 2.11, 1.49, 0.51, 0.94),"
"0","                             ""vol.max"" = c(29356, 11838, 8274, 5832, 1766, 1136),"
"0","                             ""drainage.status"" = c(""high"", ""medium"", ""low"", ""medium"", ""none"", ""none""), "
"0","                             ""pothole.cover"" = c(""CS"", ""CS"", ""CS"", ""CS"", ""CS"", ""R""),"
"0","                             ""field.cover"" = c(rep(""CS"")),"
"0","                             ""tillage"" = c(rep(""conventional"")))"
"0",""
"0","# FNCTIONS ===="
"0","quad.func <- function(a,b,c,d){"
"0","  if(delta(a,b,c,d) > 0){ # first case D>0"
"0","    x_1 = (-b+sqrt(delta(a,b,c,d)))/(2*a)"
"0","    x_2 = (-b-sqrt(delta(a,b,c,d)))/(2*a)"
"0","    result = c(x_1,x_2)"
"0","  }"
"0","  else if(delta(a,b,c,d) == 0){ # second case D=0"
"0","    x = -b/(2*a)"
"0","  }"
"0","  else {""There are no real roots.""} # third case D<0"
"0","}"
"0",""
"0","# Constructing delta"
"0","delta<-function(a,b,c,d){"
"0","  b^2-4*a*(c-d)"
"0","}"
"0",""
"0","calc.depth.data <- function(data.df, id) {"
"0","  "
"0","  depth.data.df <- data.frame(matrix(ncol=43, nrow=9131))"
"0","  colnames(depth.data.df) <- colnames(data.df)"
"0","  depth.data.df[ , c(1:4)] <- data.df[ , c(1:4)]"
"0","  "
"0","  if (id == 1){"
"0","    col = ""steelblue"""
"0","    nm = ""bunny"""
"0","    mx.d <- chars.potholes$depth.max[id]"
"0","    "
"0","    # check for range of volume, converts to depth differently"
"0","    # based on regression curves developed by Alex Martin"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(651.08, -7364.1, 35202)"
"0","    coeff.quad.A <- c(-515.92, 37752, 25940)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(2667)"
"0","    coeff.lin.A <- c()"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= coeff.lin.v[1]*0.1) {"
"0","          depth.data.df[x , y] <- data.df[x ,y] / coeff.lin.v[1]"
"0","        } else {"
"0","          roots <- quad.func(coeff.quad.v[3], coeff.quad.v[2],coeff.quad.v[1], data.df[x, y])"
"0","          depth.data.df[x , y] <- roots[1]"
"0","          if (roots[1] > chars.potholes$depth.max[id]) depth.data.df[x,y] <- chars.potholes$depth.max[id]"
"0","          "
"0","        }"
"0","        y <- y +1"
"0","      }"
"0","      x<-x+1"
"0","    }"
"0","    "
"0","    "
"0","    "
"0","  } else if (id == 2) {"
"0","    col=""tan4"""
"0","    nm = ""walnut"""
"0","    mx.d <- chars.potholes$depth.max[id]"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(-203.57, 1300.2, 19238)"
"0","    coeff.quad.A <- c(-699.71, 49183, -12568)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(1188)"
"0","    coeff.lin.A <- c()"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= coeff.lin.v[1]*0.1) {"
"0","          depth.data.df[x , y] <- data.df[x ,y] / coeff.lin.v[1]"
"0","        } else {"
"0","          roots <- quad.func(coeff.quad.v[3], coeff.quad.v[2],coeff.quad.v[1], data.df[x, y])"
"0","          depth.data.df[x , y] <- roots[1]"
"0","        }"
"0","        y <- y +1"
"0","      }"
"0","      x<-x+1"
"0","    }"
"0","    "
"0","  }else if (id == 3) {"
"0","    col=""seagreen""  "
"0","    nm = ""lettuce"""
"0","    mx.d <- chars.potholes$depth.max[id]"
"0","    "
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(211.93, -3451.1, 17871)"
"0","    coeff.quad.A <- c(-1198.1, 20716, 20544)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(455)"
"0","    coeff.lin.A <- c()"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= coeff.lin.v[1]*0.1) {"
"0","          depth.data.df[x , y] <- data.df[x ,y] / coeff.lin.v[1]"
"0","        } else {"
"0","          roots <- quad.func(coeff.quad.v[3], coeff.quad.v[2],coeff.quad.v[1], data.df[x, y])"
"0","          depth.data.df[x , y] <- roots[1]"
"0","        }"
"0","        y <- y +1"
"0","      }"
"0","      x<-x+1"
"0","    }"
"0","    "
"0","  }else if (id == 4) {"
"0","    col=""firebrick3"""
"0","    nm = ""cardinal"""
"0","    mx.d <- chars.potholes$depth.max[id]"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(-17.083, 980.2, 14492)"
"0","    coeff.quad.A <- c(-716.91, 32988, -14302)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(298.2)"
"0","    coeff.lin.A <- c()"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= coeff.lin.v[1]*0.1) {"
"0","          depth.data.df[x , y] <- data.df[x ,y] / coeff.lin.v[1]"
"0","        } else {"
"0","          roots <- quad.func(coeff.quad.v[3], coeff.quad.v[2],coeff.quad.v[1], data.df[x, y])"
"0","          depth.data.df[x , y] <- roots[1]"
"0","        }"
"0","        y <- y +1"
"0","      }"
"0","      x<-x+1"
"0","    }"
"0","    "
"0","  }else if (id == 5) {"
"0","    col=""goldenrod"""
"0","    nm = ""hen"""
"0","    mx.d <- chars.potholes$depth.max[id]"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(-15.96, 136.89, 4951.7)"
"0","    coeff.quad.A <- c(-176.28, 14187, -8648)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(472.5)"
"0","    coeff.lin.A <- c()"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= coeff.lin.v[1]*0.1) {"
"0","          depth.data.df[x , y] <- data.df[x ,y] / coeff.lin.v[1]"
"0","        } else {"
"0","          roots <- quad.func(coeff.quad.v[3], coeff.quad.v[2],coeff.quad.v[1], data.df[x, y])"
"0","          depth.data.df[x , y] <- roots[1]"
"0","        }"
"0","        y <- y +1"
"0","      }"
"0","      x<-x+1"
"0","    }"
"0","    "
"0","  }else if (id == 6) {"
"0","    col=""mediumpurple3"""
"0","    nm = ""mouth"""
"0","    mx.d <- chars.potholes$depth.max[id]"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(151, -3320, 20600)"
"0","    coeff.quad.A <- c(-1912, 26930, 36800)"
"0","    "
"0","    # linear portion coefficients, where d >= 0.1"
"0","    coeff.lin.v <- c(250)"
"0","    coeff.lin.A <- c()"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= coeff.lin.v[1]*0.1) {"
"0","          depth.data.df[x , y] <- data.df[x ,y] / coeff.lin.v[1]"
"0","        } else {"
"0","          roots <- quad.func(coeff.quad.v[3], coeff.quad.v[2],coeff.quad.v[1], data.df[x, y])"
"0","          depth.data.df[x , y] <- roots[1]"
"0","        }"
"0","        y <- y +1"
"0","      }"
"0","      x<-x+1"
"0","    }"
"0","    "
"0","  } else {"
"0","    col = ""black"""
"0","  }"
"0","  "
"0","  return(depth.data.df)"
"0","  "
"0","  "
"0","}"
"0",""
"0","calc.area.data <- function(data.df, id) {"
"0","  "
"0","  area.data.df <- data.frame(matrix(ncol=43, nrow=9131))"
"0","  colnames(area.data.df) <- colnames(data.df)"
"0","  area.data.df[ , c(1:4)] <- data.df[ , c(1:4)]"
"0","  "
"0","  if (id == 1){"
"0","    col = ""steelblue"""
"0","    nm = ""bunny"""
"0","    # mx.A <- chars.potholes$area.max[id]"
"0","    "
"0","    # check for range of volume, converts to depth differently"
"0","    # based on regression curves developed by Alex Martin"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(651.08, -7364.1, 35202)"
"0","    coeff.quad.A <- c(-515.92, 37752, 25940)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(2667)"
"0","    coeff.lin.A <- c(35187)"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= 0.1) {"
"0","          area.data.df[x , y] <- data.df[x ,y] * coeff.lin.A[1]"
"0","        } else {"
"0","          area.data.df[x , y] <- coeff.quad.A[3]*(data.df[x, y])^2 + coeff.quad.A[2]*(data.df[x, y]) +coeff.quad.A[1]"
"0","        }"
"0","        y <- y + 1"
"0","      }"
"0","      x <- x + 1"
"0","    }"
"0","    "
"0","    "
"0","    "
"0","  } else if (id == 2) {"
"0","    col=""tan4"""
"0","    nm = ""walnut"""
"0","    # mx.A <- chars.potholes$area.max[id]"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(-203.57, 1300.2, 19238)"
"0","    coeff.quad.A <- c(-699.71, 49183, -12568)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(1188)"
"0","    coeff.lin.A <- c(40929.1)"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= 0.1) {"
"0","          area.data.df[x , y] <- data.df[x ,y] * coeff.lin.A[1]"
"0","        } else {"
"0","          area.data.df[x , y] <- coeff.quad.A[3]*(data.df[x, y])^2 + coeff.quad.A[2]*(data.df[x, y]) +coeff.quad.A[1]"
"0","        }"
"0","        y <- y + 1"
"0","      }"
"0","      x <- x + 1"
"0","    }"
"0","    "
"0","  }else if (id == 3) {"
"0","    col=""seagreen""  "
"0","    nm = ""lettuce"""
"0","    # mx.A <- chars.potholes$area.max[id]"
"0","    "
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(211.93, -3451.1, 17871)"
"0","    coeff.quad.A <- c(-1198.1, 20716, 20544)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(455)"
"0","    coeff.lin.A <- c(10789.4)"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= 0.1) {"
"0","          area.data.df[x , y] <- data.df[x ,y] * coeff.lin.A[1]"
"0","        } else {"
"0","          area.data.df[x , y] <- coeff.quad.A[3]*(data.df[x, y])^2 + coeff.quad.A[2]*(data.df[x, y]) +coeff.quad.A[1]"
"0","        }"
"0","        y <- y + 1"
"0","      }"
"0","      x <- x + 1"
"0","    }"
"0","    "
"0","  }else if (id == 4) {"
"0","    col=""firebrick3"""
"0","    nm = ""cardinal"""
"0","    # mx.A <- chars.potholes$area.max[id]"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(-17.083, 980.2, 14492)"
"0","    coeff.quad.A <- c(-716.91, 32988, -14302)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(298.2)"
"0","    coeff.lin.A <- c(24388.7)"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= 0.1) {"
"0","          area.data.df[x , y] <- data.df[x ,y] * coeff.lin.A[1]"
"0","        } else {"
"0","          area.data.df[x , y] <- coeff.quad.A[3]*(data.df[x, y])^2 + coeff.quad.A[2]*(data.df[x, y]) +coeff.quad.A[1]"
"0","        }"
"0","        y <- y + 1"
"0","      }"
"0","      x <- x + 1"
"0","    }"
"0","    "
"0","  }else if (id == 5) {"
"0","    col=""goldenrod"""
"0","    nm = ""hen"""
"0","    # mx.A <- chars.potholes$area.max[id]"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(-15.96, 136.89, 4951.7)"
"0","    coeff.quad.A <- c(-176.28, 14187, -8648)"
"0","    "
"0","    # linear portion coefficients"
"0","    coeff.lin.v <- c(472.5)"
"0","    coeff.lin.A <- c(11559.4)"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= 0.1) {"
"0","          area.data.df[x , y] <- data.df[x ,y] * coeff.lin.A[1]"
"0","        } else {"
"0","          area.data.df[x , y] <- coeff.quad.A[3]*(data.df[x, y])^2 + coeff.quad.A[2]*(data.df[x, y]) +coeff.quad.A[1]"
"0","        }"
"0","        y <- y + 1"
"0","      }"
"0","      x <- x + 1"
"0","    }"
"0","    "
"0","  }else if (id == 6) {"
"0","    col=""mediumpurple3"""
"0","    nm = ""mouth"""
"0","    # mx.A <- chars.potholes$area.max[id]"
"0","    "
"0","    # quadratic portion coefficients, low order to high order"
"0","    coeff.quad.v <- c(151, -3320, 20600)"
"0","    coeff.quad.A <- c(-1912, 26930, 36800)"
"0","    "
"0","    # linear portion coefficients, where d <= 0.1"
"0","    coeff.lin.v <- c(250)"
"0","    coeff.lin.A <- c(11490)"
"0","    "
"0","    x = 1"
"0","    y = 5"
"0","    while (x <= length(data.df$Gregorian)) {"
"0","      y = 5"
"0","      while (y<=43) {"
"0","        if (data.df[x , y] <= 0.1) {"
"0","          area.data.df[x , y] <- data.df[x ,y] * coeff.lin.A[1]"
"0","        } else {"
"0","          area.data.df[x , y] <- coeff.quad.A[3]*(data.df[x, y])^2 + coeff.quad.A[2]*(data.df[x, y]) +coeff.quad.A[1]"
"0","        }"
"0","        y <- y + 1"
"0","      }"
"0","      x <- x + 1"
"0","    }"
"0","    "
"0","  } else {"
"0","    col = ""black"""
"0","  }"
"0","  "
"0","  return(area.data.df)"
"0","  "
"0","  "
"0","}"
"0",""
"0","# CREATE AND SAVE DEPTH DATA ====="
"0","depth.bunny.df <- calc.depth.data(vol.bunny.df, 1)"
"0","depth.walnut.df <- calc.depth.data(vol.walnut.df, 2)"
"0","depth.lettuce.df <- calc.depth.data(vol.lettuce.df, 3)"
"0","depth.cardinal.df <- calc.depth.data(vol.cardinal.df, 4)"
"0","depth.hen.df <- calc.depth.data(vol.hen.df, 5)"
"0","depth.mouth.df <- calc.depth.data(vol.mouth.df, 6)"
"0",""
"0","# save csv"
"0","write.csv(depth.bunny.df, file = ""depth_time_series_bunny.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(depth.walnut.df, file = ""depth_time_series_walnut.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(depth.lettuce.df, file = ""depth_time_series_lettuce.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(depth.cardinal.df, file = ""depth_time_series_cardinal.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(depth.hen.df, file = ""depth_time_series_hen.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(depth.mouth.df, file = ""depth_time_series_mouth.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","# CREATE AND SAVE AREA DATA ====="
"0","area.bunny.df <- calc.area.data(depth.bunny.df, 1)"
"0","area.walnut.df <- calc.area.data(depth.walnut.df, 2)"
"0","area.lettuce.df <- calc.area.data(depth.lettuce.df, 3)"
"0","area.cardinal.df <- calc.area.data(depth.cardinal.df, 4)"
"0","area.hen.df <- calc.area.data(depth.hen.df, 5)"
"0","area.mouth.df <- calc.area.data(depth.mouth.df, 6)"
"0",""
"0","# save csv "
"0","write.csv(area.bunny.df, file = ""area_time_series_bunny.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(area.walnut.df, file = ""area_time_series_walnut.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(area.lettuce.df, file = ""area_time_series_lettuce.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(area.cardinal.df, file = ""area_time_series_cardinal.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(area.hen.df, file = ""area_time_series_hen.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
"0","write.csv(area.mouth.df, file = ""area_time_series_mouth.csv"", sep = "","", col.names = TRUE)"
"2","attempt to set 'col.names' ignored"
"2","attempt to set 'sep' ignored"
