"0",""
"0","# SETUP ====="
"0","library(tidyr)"
"0","library(ggplot2)"
"0","library(gridExtra)"
"0","library(ggpubr)"
"0","library(purrr)"
"0",""
"0","# events.data.all <- events.data.all[ , c(5:45)]"
"0","# # write.csv(events.data.all, file = ""eventsdata.csv"")"
"0","# events.data.all <- events.data.all[ , c(40, 41, 22+1, 23+1, 24+1, 3+1, 12+1, 13+1, 1+1, 4+1, 14+1, 25+1, 19+1, 29+1, 33+1, "
"0","#                                         36+1, 5+1, 15+1, 26+1, 20+1, 30+1, 34+1, 37+1, 6+1, 16+1, 27+1, 21+1, 31+1, 35+1, 38+1)]"
"0","# colnames(events.data.all) <- c(""Pothole"", ""consecdays"", "
"0","#                                ""D0-CS-CV"", ""D0-CS-CT"", ""D0-CS-NT"", ""D0-R-CV"", ""D0-R-CT"", ""D0-R-NT"",""D0-R-R"", "
"0","#                                ""D1-CS-CV"", ""D1-CS-CT"", ""D1-CS-NT"", ""D1-R-CV"", ""D1-R-CT"", ""D1-R-NT"",""D1-R-R"", "
"0","#                                ""D2-CS-CV"", ""D2-CS-CT"", ""D2-CS-NT"", ""D2-R-CV"", ""D2-R-CT"", ""D2-R-NT"",""D2-R-R"","
"0","#                                ""D3-CS-CV"", ""D3-CS-CT"", ""D3-CS-NT"", ""D3-R-CV"", ""D3-R-CT"", ""D3-R-NT"",""D3-R-R"")"
"0",""
"0","events.data.all.gather <- events.data.all %>%"
"0","  gather(key=""code"", value=""count"", 3:30)"
"0",""
"0","events.test <- events.data.all.gather %>%"
"0","  # filter(code %in% simulation_shortIDs$Drain0) %>%"
"0","  group_by(code) %>%"
"0","  summarise(one = sum(count[consecdays == 1]), two = sum(count[consecdays >= 2 & consecdays <= 4]),"
"0","            five = sum(count[consecdays >= 5 & consecdays < 10]), tenp = sum(count[consecdays >= 10])) %>%"
"0","  gather(key=""length"", value=""value"", 2:5) %>%"
"0","  as.data.frame()"
"0",""
"0","events.test$value <- events.test$value / 6"
"0",""
"0","#"
"0","# head(events.drain.comp)"
"0","# head(events.retire.comp)"
"0","# head(events.tillage.comp)"
"0","events.test$code <- c(rep(c(""D0-CS-CT"","
"0","      ""D0-CS-CV"","
"0","      ""D0-CS-NT"","
"0","      ""D0-R-CT"","
"0","      ""D0-R-CV"","
"0","      ""D0-R-NT"","
"0","      ""D0-R-R"","
"0","      ""D1-CS-CT"","
"0","      ""D1-CS-CV"","
"0","      ""D1-CS-NT"","
"0","      ""D1-R-CT"","
"0","      ""D1-R-CV"","
"0","      ""D1-R-NT"","
"0","      ""D1-R-R"","
"0","      ""D2-CS-CT"","
"0","      ""D2-CS-CV"","
"0","      ""D2-CS-NT"","
"0","      ""D2-R-CT"","
"0","      ""D2-R-CV"","
"0","      ""D2-R-NT"","
"0","      ""D2-R-R"","
"0","      ""D3-CS-CT"","
"0","      ""D3-CS-CV"","
"0","      ""D3-CS-NT"","
"0","      ""D3-R-CT"","
"0","      ""D3-R-CV"","
"0","      ""D3-R-NT"","
"0","      ""D3-R-R""), 4))"
"0",""
"0","events.test$code2 <- events.test$code"
"0",""
"0","events.test$code2 <-"
"0","  factor("
"0","    events.test$code,"
"0","    levels = c("
"0","      ""D0-CS-CV"","
"0","      ""D0-CS-CT"","
"0","      ""D0-CS-NT"","
"0","      ""D0-R-CV"","
"0","      ""D0-R-CT"","
"0","      ""D0-R-NT"","
"0","      ""D0-R-R"","
"0","      ""D1-CS-CV"","
"0","      ""D1-CS-CT"","
"0","      ""D1-CS-NT"","
"0","      ""D1-R-CV"","
"0","      ""D1-R-CT"","
"0","      ""D1-R-NT"","
"0","      ""D1-R-R"","
"0","      ""D2-CS-CV"","
"0","      ""D2-CS-CT"","
"0","      ""D2-CS-NT"","
"0","      ""D2-R-CV"","
"0","      ""D2-R-CT"","
"0","      ""D2-R-NT"","
"0","      ""D2-R-R"","
"0","      ""D3-CS-CV"","
"0","      ""D3-CS-CT"","
"0","      ""D3-CS-NT"","
"0","      ""D3-R-CV"","
"0","      ""D3-R-CT"","
"0","      ""D3-R-NT"","
"0","      ""D3-R-R"""
"0","    )"
"0","  )"
"0",""
"0","# Functions ====="
"0","plot.event.count2 <- function(data.df, filterid) {"
"0","  "
"0","  df <- data.df %>%"
"0","    filter(code %in% simulation_shortIDs[ , filterid]) "
"0","  "
"0","  # png(paste(""plot.event.count."",nm,"".png""), width = 800, height = 600)"
"0","  # windows()"
"0","  plot.count <- ggplot(data=df, aes(x=consecdays, y=count, color=Pothole))+"
"0","    geom_point()+"
"0","    facet_grid(rows = vars(code))+"
"0","    labs("
"0","      x = ""Duration of Event (days)"","
"0","      y = ""Count of Event"""
"0","    )"
"0","  "
"0","  return(plot.count)"
"0","}"
"0",""
"0","# AGGREGATED ====="
"0","plot.events.aggregated <- function(data.df, filterid) {"
"0","  "
"0","  df <- data.df %>%"
"0","    # as.data.frame() %>%"
"0","    filter(code %in% simulation_shortIDs[ , filterid]) "
"0","  "
"0","  df$length2 <- factor(df$length, levels = c(""one"", ""two"", ""five"", ""tenp""))"
"0","  "
"0","  # windows()"
"0","  plot.count <- ggplot(data=df, aes(x=length2, y=value, fill=code2))+"
"0","    theme_bw(base_size = 9)+"
"0","    geom_bar(stat=""identity"", position = ""dodge"", alpha = 0.5)+"
"0","    labs("
"0","      x = """","
"0","      y = """","
"0","      fill = ""Scenario"""
"0","    ) +"
"0","    ylim(0, 110) +"
"0","    scale_x_discrete(labels=c(""1"", ""2-4"", ""5-9"", ""10+"")) +"
"0","    scale_fill_brewer(palette = ""Dark2"")"
"0","  "
"0","  return(plot.count)"
"0","  "
"0","}"
