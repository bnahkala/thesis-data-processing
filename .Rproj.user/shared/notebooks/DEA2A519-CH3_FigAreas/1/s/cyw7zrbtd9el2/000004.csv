"0",""
"0","# LIBRARY ===="
"0","library(tidyr)"
"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(reshape2)"
"2","
Attaching package: ‘reshape2’

"
"2","The following object is masked from ‘package:tidyr’:

    smiths

"
"0","library(ggpubr)"
"0",""
"0","# SCENARIOS ===== "
"0",""
"0","simulation_numbers <- data.frame(""Drain0"" = c(22, 23, 24, 3, 12, 13, 1),"
"0","                                 ""Drain1"" = c(4, 14, 25, 19, 29, 33, 36),"
"0","                                 ""Drain2"" = c(5, 15, 26, 20, 30, 34, 37),"
"0","                                 ""Drain3"" = c(6, 16, 27, 21, 31, 35, 38))"
"0","simulation_numbers2 <- data.frame(""CSCV"" = c(22, 4, 5, 6),"
"0","                                  ""CSCT"" = c(23, 14, 15, 16),"
"0","                                  ""CSNT"" = c(24, 25, 26, 27),"
"0","                                  ""RCV"" = c(3, 19, 20, 21),"
"0","                                  ""RCT"" = c(12, 29, 30, 31),"
"0","                                  ""RNT"" = c(13, 33, 34, 35),"
"0","                                  ""RR"" = c(1, 36, 37, 38))"
"0",""
"0","simulation_numbers3 <- data.frame(""PDCC"" = c(0, 7, 8, 9, 10, 17))"
"0",""
"0","simulation_shortIDs <- data.frame(""Drain0"" = c(""D0-CS-CV"", ""D0-CS-CT"", ""D0-CS-NT"", ""D0-R-CV"", ""D0-R-CT"", ""D0-R-NT"",""D0-R-R""),"
"0","                                  ""Drain1"" = c(""D1-CS-CV"", ""D1-CS-CT"", ""D1-CS-NT"", ""D1-R-CV"", ""D1-R-CT"", ""D1-R-NT"",""D1-R-R""),"
"0","                                  ""Drain2"" = c(""D2-CS-CV"", ""D2-CS-CT"", ""D2-CS-NT"", ""D2-R-CV"", ""D2-R-CT"", ""D2-R-NT"",""D2-R-R""),"
"0","                                  ""Drain3"" = c(""D3-CS-CV"", ""D3-CS-CT"", ""D3-CS-NT"", ""D3-R-CV"", ""D3-R-CT"", ""D3-R-NT"",""D3-R-R""))"
"0","simulation_shortIDs2 <- data.frame(""CSCV"" = c(""D0-CS-CV"", ""D1-CS-CV"", ""D2-CS-CV"", ""D3-CS-CV""),"
"0","                                   ""CSCT"" = c(""D0-CS-CT"", ""D1-CS-CT"", ""D2-CS-CT"", ""D3-CS-CT""),"
"0","                                   ""CSNT"" = c(""D0-CS-NT"", ""D1-CS-NT"", ""D2-CS-NT"", ""D3-CS-NT""),"
"0","                                   ""RCV"" = c(""D0-R-CV"", ""D1-R-CV"", ""D2-R-CV"", ""D3-R-CV""),"
"0","                                   ""RCT"" = c(""D0-R-CT"", ""D1-R-CT"", ""D2-R-CT"", ""D3-R-CT""),"
"0","                                   ""RNT"" = c(""D0-R-NT"", ""D1-R-NT"", ""D2-R-NT"", ""D3-R-NT""),"
"0","                                   ""RR"" = c(""D0-R-R"", ""D1-R-R"", ""D2-R-R"", ""D3-R-R""))"
"0","simulation_shortIDs3 <- data.frame(""PDCC"" = c(""DX-X-CV"",""PD-2E"", ""PD-2L"", ""PD-4L"", ""PD-6L"", ""DX-CC-NT""))"
"0",""
"0","simulation_names <- data.frame(""Drain0"" = c(""Drain0"", ""Drain0CT"", ""Drain0NT"", ""RetiredPothole"", ""ConTillRetired"", ""NoTillRetired"",""RetiredAll""),"
"0","                               ""Drain1"" = c(""Drain01"", ""ConTillDrain01"", ""Drain1NT"", ""Drain1Retired"", ""Drain1RetiredCT"", ""Drain1RetiredNT"",""Drain1RetiredAll""),"
"0","                               ""Drain2"" = c(""Drain02"", ""ConTillDrain02"", ""Drain2NT"", ""Drain2Retired"", ""Drain2RetiredCT"", ""Drain2RetiredNT"",""Drain2RetiredAll""),"
"0","                               ""Drain3"" = c(""Drain03"", ""ConTillDrain03"", ""Drain3NT"", ""Drain3Retired"", ""Drain3RetiredCT"", ""Drain3RetiredNT"",""Drain3RetiredAll""))"
"0",""
"0","simulation_names2 <- data.frame(""CSCV"" = c(""Drain0"", ""Drain01"", ""Drain02"", ""Drain03""),"
"0","                                ""CSCT"" = c(""Drain0CT"", ""ConTillDrain01"", ""ConTillDrain02"", ""ConTillDrain03""),"
"0","                                ""CSNT"" = c(""Drain0NT"", ""Drain1NT"", ""Drain2NT"", ""Drain3NT""),"
"0","                                ""RCV"" = c(""RetiredPothole"", ""Drain1Retired"", ""Drain2Retired"", ""Drain3Retired""),"
"0","                                ""RCT"" = c(""ConTillRetired"", ""Drain1RetiredCT"", ""Drain2RetiredCT"", ""Drain3RetiredCT""),"
"0","                                ""RNT"" = c(""NoTillRetired"", ""Drain1RetiredNT"", ""Drain2RetiredNT"", ""Drain3RetiredNT""),"
"0","                                ""RR"" = c(""RetiredAll"", ""Drain1RetiredAll"", ""Drain2RetiredAll"", ""Drain3RetiredAll""))"
"0","simulation_names3 <- data.frame(""PDCC"" = c(""Base"", ""PlantDate01"", ""PlantDate02"", ""PlantDate03"", ""PlantDate04"", ""CoverCrop""))"
"0",""
"0",""
"0",""
"0","# FUNCTIONS ===="
"0","# function originally from 'AnnAGNPS_Output.Rproj' -> data_functions.R"
"0","find.monthly.max <- function(data.df) {"
"0","  max.by.month <- data.df %>%"
"0","    dplyr::group_by(Year, Month) %>%"
"0","    dplyr::summarise("
"0","      Base = max(Base),"
"0","      RetiredAll = max(RetiredAll),"
"0","      ConTill = max(ConTill),"
"0","      RetiredPothole = max(RetiredPothole),"
"0","      Drain01 = max(Drain01),"
"0","      Drain02 = max(Drain02),"
"0","      Drain03 = max(Drain03),"
"0","      PlantDate01 = max(PlantDate01),"
"0","      PlantDate02 = max(PlantDate02),"
"0","      PlantDate03 = max(PlantDate03),"
"0","      PlantDate04 = max(PlantDate04),"
"0","      NoTill = max(NoTill),"
"0","      ConTillRetired = max(ConTillRetired),"
"0","      NoTillRetired = max(NoTillRetired),"
"0","      ConTillDrain01 = max(ConTillDrain01),"
"0","      ConTillDrain02 = max(ConTillDrain02),"
"0","      ConTillDrain03 = max(ConTillDrain03),"
"0","      CoverCrop = max(CoverCrop),"
"0","      BaseRetired = max(BaseRetired),"
"0","      Drain1Retired = max(Drain1Retired),"
"0","      Drain2Retired = max(Drain2Retired),"
"0","      Drain3Retired = max(Drain3Retired),"
"0","      Drain0 = max(Drain0),"
"0","      Drain0CT = max(Drain0CT),"
"0","      Drain0NT = max(Drain0NT),"
"0","      Drain1NT = max(Drain1NT),"
"0","      Drain2NT = max(Drain2NT),"
"0","      Drain3NT = max(Drain3NT),"
"0","      BaseRetiredCT = max(BaseRetiredCT),"
"0","      Drain1RetiredCT = max(Drain1RetiredCT),"
"0","      Drain2RetiredCT = max(Drain2RetiredCT),"
"0","      Drain3RetiredCT = max(Drain3RetiredCT),"
"0","      BaseRetiredNT = max(BaseRetiredNT),"
"0","      Drain1RetiredNT = max(Drain1RetiredNT),"
"0","      Drain2RetiredNT = max(Drain2RetiredNT),"
"0","      Drain3RetiredNT = max(Drain3RetiredNT),"
"0","      Drain1RetiredAll = max(Drain1RetiredAll),"
"0","      Drain2RetiredAll = max(Drain2RetiredAll),"
"0","      Drain3RetiredAll = max(Drain3RetiredAll)"
"0","    )"
"0","  return(max.by.month)"
"0","}"
"0",""
"0","# function originally from 'AnnAGNPS_Output.Rproj' -> data_viz_functions.R"
"0","plot.max.monthly <- function(data.df, id) {"
"0","  "
"0","  mm <- data.df %>%"
"0","    group_by(Month) %>%"
"0","    summarise(Base=max(Base), RetiredAll=max(RetiredAll), ConTill =max(ConTill), "
"0","              RetiredPothole=max(RetiredPothole), Drain01=max(Drain01), Drain02=max(Drain02),"
"0","              Drain03=max(Drain03), PlantDate01=max(PlantDate01), PlantDate02=max(PlantDate02),"
"0","              PlantDate03=max(PlantDate03), PlantDate04=max(PlantDate04), NoTill=max(NoTill),"
"0","              ConTillRetired=max(ConTillRetired), NoTillRetired=max(NoTillRetired), "
"0","              ConTillDrain01=max(ConTillDrain01), ConTillDrain02=max(ConTillDrain02),ConTillDrain03=max(ConTillDrain03),"
"0","              CoverCrop=max(CoverCrop), BaseRetired=max(BaseRetired), Drain1Retired=max(Drain1Retired), "
"0","              Drain2Retired=max(Drain2Retired), Drain3Retired=max(Drain3Retired)) %>%"
"0","    melt(id=""Month"") %>%"
"0","    as.data.frame()"
"0","  "
"0","  if (id == 1){"
"0","    col = ""steelblue"""
"0","    nm = ""bunny"""
"0","  } else if (id == 2) {"
"0","    col=""tan4"""
"0","    nm = ""walnut"""
"0","  }else if (id == 3) {"
"0","    col=""seagreen""  "
"0","    nm = ""lettuce"""
"0","  }else if (id == 4) {"
"0","    col=""firebrick3"""
"0","    nm = ""cardinal"""
"0","  }else if (id == 5) {"
"0","    col=""goldenrod"""
"0","    nm = ""hen"""
"0","  }else if (id == 6) {"
"0","    col=""mediumpurple3"""
"0","    nm = ""mouth"""
"0","  } else {"
"0","    col = ""black"""
"0","  }"
"0","  "
"0","  png(paste(""median.max.monthly.plot."",nm, "".png""), width = 1200, height = 800)"
"0","  # windows()"
"0","  plot.all <- ggplot(mm, aes(x=Month, y=value))+"
"0","    geom_bar(stat=""identity"", fill=col)+"
"0","    facet_wrap(~variable)+"
"0","    ylim(0, 7500)+"
"0","    labs("
"0","      x=""Month"","
"0","      y=""Average Monthly Maximum Volume (m^3)"")"
"0","  "
"0","  "
"0","  "
"0","  return(plot.all)"
"0","}"
"0",""
"0","# function originally from 'AnnAGNPS_Output.Rproj' -> data_partitioning.R"
"0","max.function.partitioned3 <- function(data.df, id, supp.labs, labnms) {"
"0","  temp <- data.df %>%"
"0","    group_by(Month, Pothole, scen) %>%"
"0","    summarise(avg.max=mean(value), median.max=median(value)) #%>%"
"0","    # filter(avg.max != 0)"
"0","  "
"0","  labs <- as.character(supp.labs)"
"0","  names(labs) <- as.character(labnms)"
"0","  "
"0","  png(filename = paste0(""avg_"", id, ""_comparison.png""), width=800, height=500)"
"0","  # windows()"
"0","  plot.max <- ggplot(temp, aes(x=Month, y=avg.max, fill=Pothole))+"
"0","    geom_bar(stat=""identity"")+"
"0","    facet_grid(cols = vars(scen), rows = vars(Pothole), labeller = labeller(scen = labs))+"
"0","    ylim(0, 25000)+"
"0","    theme(axis.text.x = element_text(angle = 90))+"
"0","    theme(text = element_text(size=9))+"
"0","    theme(legend.position = ""none"")+"
"0","    labs("
"0","      x="""","
"0","      y="""")+"
"0","    scale_fill_brewer(palette = ""Dark2"", labels=c(""DX-CS-CV"",""DX-CS-CT"",""DX-CS-NT"",""DX-R-CV"",""DX-R-CT"",""DX-R-NT"",""DX-R-R""))"
"0","  plot.max"
"0","  return(plot.max)"
"0","}"
"0",""
"0","# DATA PREP ===="
"0","area.max.month.bunny <- find.monthly.max(area.bunny.df)"
"0","area.max.month.walnut <- find.monthly.max(area.walnut.df)"
"0","area.max.month.lettuce <- find.monthly.max(area.lettuce.df)"
"0","area.max.month.cardinal <- find.monthly.max(area.cardinal.df)"
"0","area.max.month.hen <- find.monthly.max(area.hen.df)"
"0","area.max.month.mouth <- find.monthly.max(area.mouth.df)"
"0",""
"0","data.for.partitioning2 <- rbind(area.max.month.bunny, area.max.month.walnut, area.max.month.lettuce, "
"0","                                area.max.month.cardinal, area.max.month.hen, area.max.month.mouth)"
"0","data.for.partitioning2$Pothole <- c(rep(""Bunny"", 300), rep(""Walnut"", 300), rep(""Lettuce"", 300),"
"0","                                    rep(""Cardinal"", 300), rep(""Hen"", 300), rep(""Mouth"", 300))"
"0","# data.for.partitioning2 <- melt(data.for.partitioning2, id=c(""Year"", ""Month"", ""Pothole""))"
"0",""
"0",""
"0","# PARTITIONING DATA ====="
"0",""
"0","# drainage matrices ===="
"0",""
"0","max.data.drain0 <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers$Drain0+3))]"
"0","max.data.drain0 <- max.data.drain0 %>%"
"0","  gather(""variable"", ""value"", 4:10)"
"0",""
"0","max.data.drain0$scen <- factor(max.data.drain0$variable, levels = c(""Drain0"", ""Drain0CT"", ""Drain0NT"","
"0","                                                                    ""RetiredPothole"", ""ConTillRetired"","
"0","                                                                    ""NoTillRetired"", ""RetiredAll""))"
"0",""
"0","# max.data.drain0.filter <- max.data.drain0 %>%"
"0","#   filter(Pothole != ""Mouth"" & Pothole != ""Hen"") %>%"
"0","#   filter(variable == ""Drain0"" | variable == ""RetiredPothole"" | variable == ""RetiredAll"")"
"0",""
"0","max.data.drain1 <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers$Drain1+3))]"
"0","max.data.drain1 <- max.data.drain1 %>%"
"0","  gather(""variable"", ""value"", 4:10)"
"0",""
"0","max.data.drain1$scen <- factor(max.data.drain1$variable, levels=c(""Drain01"", ""ConTillDrain01"", ""Drain1NT"","
"0","                                                                   ""Drain1Retired"", ""Drain1RetiredCT"", "
"0","                                                                   ""Drain1RetiredNT"", ""Drain1RetiredAll""))"
"0",""
"0","max.data.drain2 <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers$Drain2+3))]"
"0","max.data.drain2 <- max.data.drain2 %>%"
"0","  gather(""variable"", ""value"", 4:10)"
"0",""
"0","max.data.drain2$scen <- factor(max.data.drain2$variable, levels=c(""Drain02"", ""ConTillDrain02"", ""Drain2NT"","
"0","                                                                  ""Drain2Retired"", ""Drain2RetiredCT"", "
"0","                                                                  ""Drain2RetiredNT"", ""Drain2RetiredAll""))"
"0",""
"0",""
"0","max.data.drain3 <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers$Drain3+3))]"
"0","max.data.drain3 <- max.data.drain3 %>%"
"0","  gather(""variable"", ""value"", 4:10)"
"0",""
"0","max.data.drain3$scen <- factor(max.data.drain3$variable, levels=c(""Drain03"", ""ConTillDrain03"", ""Drain3NT"","
"0","                                                                  ""Drain3Retired"", ""Drain3RetiredCT"", "
"0","                                                                  ""Drain3RetiredNT"", ""Drain3RetiredAll""))"
"0",""
"0",""
"0","# tillage matrices ===="
"0","max.data.CSCV <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers2$CSCV)+3)]"
"0","max.data.CSCV <- max.data.CSCV %>%"
"0","  gather(""variable"", ""value"", 4:7)"
"0",""
"0","max.data.CSCT <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers2$CSCT)+3)]"
"0","max.data.CSCT <- max.data.CSCT %>%"
"0","  gather(""variable"", ""value"", 4:7)"
"0",""
"0","max.data.CSNT <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers2$CSNT)+3)]"
"0","max.data.CSNT <- max.data.CSNT %>%"
"0","  gather(""variable"", ""value"", 4:7)"
"0",""
"0","max.data.RCV <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers2$RCV)+3)]"
"0","max.data.RCV <- max.data.RCV %>%"
"0","  gather(""variable"", ""value"", 4:7)"
"0",""
"0","max.data.RCT <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers2$RCT)+3)]"
"0","max.data.RCT <- max.data.RCT %>%"
"0","  gather(""variable"", ""value"", 4:7)"
"0",""
"0","max.data.RNT <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers2$RNT)+3)]"
"0","max.data.RNT <- max.data.RNT %>%"
"0","  gather(""variable"", ""value"", 4:7)"
"0",""
"0","max.data.RR <- data.for.partitioning2[ , c(1:2, 42, (simulation_numbers2$RR)+3)]"
"0","max.data.RR <- max.data.RR %>%"
"0","  gather(""variable"", ""value"", 4:7)"
"0",""
"0",""
"0","# APPLY PLOT FUNCTIONS ======"
"0",""
"0","# drainage matrices ===="
"0",""
"0","m1 <- max.function.partitioned3(max.data.drain0, ""drain0"", simulation_shortIDs$Drain0, simulation_names$Drain0)"
"0","dev.off()"
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","# max.function.partitioned2(max.data.drain0.filter, ""Simulation Comparison, No Drainage Present"", ""drain0_abbr"", simulation_shortIDs$Drain0, simulation_names$Drain0)"
"0","# dev.off()"
"0",""
"0","m2 <- max.function.partitioned3(max.data.drain1, ""drain1"", simulation_shortIDs$Drain1, simulation_names$Drain1)"
"0","dev.off()"
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","m3 <- max.function.partitioned3(max.data.drain2, ""drain2"", simulation_shortIDs$Drain2, simulation_names$Drain2)"
"0","dev.off()"
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","m4 <- max.function.partitioned3(max.data.drain3, ""drain3"", simulation_shortIDs$Drain3, simulation_names$Drain3)"
"0","dev.off()"
"1","null device "
"1","
"
"1","          1 "
"1","
"
"0","# windows()"
"0","png(filename = ""pub_maxplot.png"", width=1000, height=750)"
"0","arr <- ggarrange("
"0","  m1+theme(axis.text.x = element_blank()),"
"0","  m2+theme(axis.text.x = element_blank(), axis.text.y = element_blank()),"
"0","  m3,"
"0","  m4+theme(axis.text.y = element_blank()),"
"0","  labels = c(""A"", ""B"", ""C"", ""D""),"
"0","  ncol = 2,"
"0","  nrow = 2"
"0",")"
"0","annotate_figure(arr, "
"0","                left =text_grob(""Pothole Surface Area (m^2)"", rot = 90),"
"0","                bottom = text_grob(""Month""))"
